function EFFECT:Init( data )  self.Position = data:GetStart()  self.WeaponEnt = data:GetEntity()  self.Attachment = data:GetAttachment()   self.StartPos = self:GetTracerShootPos( self.Position, self.WeaponEnt, self.Attachment )  self.EndPos = data:GetOrigin()   self.Life = 0   self:SetRenderBoundsWS( self.StartPos, self.EndPos )   local pos = self.EndPos   local emitter = ParticleEmitter(pos)  emitter:SetNearClip(24, 32)   local grav = Vector(0, 0, -400)   for i=1, math.random(70, 80) do  local heading = VectorRand()  heading:Normalize()   local particle = emitter:Add("effects/spark", pos + heading * 8)  particle:SetVelocity((10 + (math.random(10) == 1 and math.random(30, 60) or 0)) * heading)  particle:SetDieTime(0.6)  particle:SetStartAlpha(255)  particle:SetEndAlpha(0)  particle:SetStartSize(1, 2)  particle:SetEndSize(0)  particle:SetColor(170, 80, 0)  particle:SetRoll(math.Rand(0, 360))  particle:SetRollDelta(math.Rand(-10, 10))  particle:SetGravity(grav)  particle:SetAirResistance(250)  particle:SetCollide(true)  end   emitter:Finish() emitter = nil collectgarbage("step", 64) end  function EFFECT:Think( )  self.Life = self.Life + FrameTime() * 7   return self.Life < 1 end  local beammat = Material("trails/physbeam") local firemat = Material("effects/fire_cloud2") local glowmat = Material("effects/yellowflare") function EFFECT:Render()  local texcoord = math.Rand(0, 1)   local norm = (self.StartPos - self.EndPos) * self.Life  local nlen = norm:Length()   local alpha = 1 - self.Life   render.SetMaterial(beammat)  for i = 0, 3 do  render.DrawBeam(self.StartPos, self.EndPos, 10, texcoord, texcoord + nlen / 16, Color(255, 100, 90, 255 * alpha))  end   render.SetMaterial(firemat)  for i = 0, 3 do  render.DrawBeam(self.StartPos, self.EndPos, 5, texcoord, texcoord + nlen / 16, Color(205, 170, 150, 255 * alpha))  end  render.DrawBeam(self.StartPos, self.EndPos, 9, texcoord, texcoord + nlen / 16, Color(255, 250, 30, 30 * alpha))   render.SetMaterial(glowmat)  render.DrawSprite(self.StartPos, 20, 20, Color(255, 190, 100, 148 * alpha))   for i = 0, 3 do  local size_reduc = i * -15   render.DrawSprite(self.EndPos, 60 + size_reduc, 60 + size_reduc, Color(255, 230 - i * 30, 180 - i * 30, 148 * alpha))  end end 