function EFFECT:Init( data )  self.Position = data:GetStart()  self.WeaponEnt = data:GetEntity()  self.Attachment = data:GetAttachment()   self.StartPos = self:GetTracerShootPos( self.Position, self.WeaponEnt, self.Attachment )  self.EndPos = data:GetOrigin()   self.Life = 0   self:SetRenderBoundsWS( self.StartPos, self.EndPos ) end  function EFFECT:Think( )  self.Life = self.Life + FrameTime() * 10    self.StartPos = self:GetTracerShootPos( self.Position, self.WeaponEnt, self.Attachment )   return self.Life < 1 end  local beammat = Material("trails/smoke") local glowmat = Material("sprites/light_glow02_add") function EFFECT:Render()  local texcoord = math.Rand( 0, 1 )   local norm = (self.StartPos - self.EndPos) * self.Life  local dir = (self.StartPos - self.EndPos):Angle()  local dfwd = dir:Forward()  local dup = dir:Up()  local drgt = dir:Right()  local nlen = norm:Length()   local prevspinpos = self.StartPos  local alpha = 1 - self.Life   local emitter = ParticleEmitter(self.EndPos)  emitter:SetNearClip(24, 32)   local particle = emitter:Add("effects/blueflare"..math.random(1, 1), self.EndPos - (self.EndPos - self.StartPos) * math.Rand(0, 1))  local vel = VectorRand():GetNormal() * 25  particle:SetDieTime(1)  particle:SetColor(255,45,45)  particle:SetColor(255,45,45)  particle:SetStartAlpha(125)  particle:SetEndAlpha(0)  particle:SetStartSize(2)  particle:SetEndSize(0)  particle:SetVelocity(vel)  particle:SetGravity(vel * -0.5)  particle:SetRoll(math.random(360))   emitter:Finish() emitter = nil collectgarbage("step", 64)   render.SetMaterial(beammat)  for i = 0, nlen, 32 do  if i > 704 then break end     local set = i - CurTime() * 15   local basebeampos = self.StartPos - dfwd * i  local spinbeampos = basebeampos + dup * math.sin(set) * 6 + drgt * math.cos(set) * 6   if i == 704 then spinbeampos = basebeampos end     render.DrawBeam(prevspinpos, spinbeampos, 3, texcoord + i, texcoord + nlen / 128 + i, Color(255, 0, 0, 255 * alpha))   prevspinpos = spinbeampos  end   for i = 0, 4 do  render.DrawBeam(self.StartPos, self.EndPos, 2.3, texcoord, texcoord + nlen / 128, Color(145, 45, 45, 200 * alpha))  end  render.DrawBeam(self.StartPos, self.EndPos, 8.5, texcoord, texcoord + nlen / 128, Color(255, 15, 15, 255 * alpha))   render.SetMaterial(glowmat)  render.DrawSprite(self.StartPos, 50, 50, Color(255, 0, 0, 200 * alpha))  render.DrawSprite(self.EndPos, 50, 50, Color(255, 25, 25, 148 * alpha)) end