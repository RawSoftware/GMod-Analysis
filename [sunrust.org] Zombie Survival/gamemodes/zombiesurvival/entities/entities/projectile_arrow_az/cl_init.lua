include("shared.lua")  local colTrail = Color(170, 75, 0, 255) local matGlow = Material("sprites/light_glow02_add") local matGlow2 = Material("particles/smokey") local matWhite = Material("models/debug/debugwhite") local vector_origin = vector_origin  function ENT:Draw()  render.ModelMaterialOverride(matWhite)  render.SetColorModulation(0.6, 0.3, 0.1)  self:DrawModel()  render.SetColorModulation(1, 1, 1)  render.ModelMaterialOverride(nil)   local pos = self:GetPos()   if self:GetVelocity():LengthSqr() > 100 then  self:SetAngles(self:GetVelocity():Angle())   render.SetMaterial(matGlow)  render.DrawSprite(pos, 7, 2, Color(170, 75, 0, 255))  render.DrawSprite(pos, 2, 14, Color(170, 75, 0, 255))   local emitter = ParticleEmitter(pos)  emitter:SetNearClip(24, 32)   local type = self:GetDTInt(0)  if type == 0 then  local particle  particle = emitter:Add(matGlow2, pos)  particle:SetVelocity(VectorRand() * 25)  particle:SetDieTime(0.5)  particle:SetStartAlpha(5)  particle:SetEndAlpha(0)  particle:SetStartSize(6)  particle:SetEndSize(0)  particle:SetRollDelta(math.Rand(-10, 10))  particle:SetColor(170, 75, 0)  elseif type == 1 then  particle = emitter:Add(matGlow2, pos)  particle:SetVelocity(VectorRand() * 25)  particle:SetDieTime(0.5)  particle:SetStartAlpha(5)  particle:SetEndAlpha(0)  particle:SetStartSize(6)  particle:SetEndSize(0)  particle:SetRollDelta(math.Rand(-10, 10))  particle:SetColor(170, 75, 170)  elseif type == 2 then  particle = emitter:Add(matGlow2, pos)  particle:SetVelocity(VectorRand() * 25)  particle:SetDieTime(0.5)  particle:SetStartAlpha(5)  particle:SetEndAlpha(0)  particle:SetStartSize(6)  particle:SetEndSize(0)  particle:SetRollDelta(math.Rand(-10, 10))  particle:SetColor(130, 150, 170)  end   emitter:Finish() emitter = nil collectgarbage("step", 64)  end end  function ENT:OnRemove()  local pos = self:GetPos()   sound.Play("hl1/ambience/steamburst1.wav", pos, 75, math.Rand(250, 255))   local c = colTrail   local emitter = ParticleEmitter(pos)  emitter:SetNearClip(24, 32)  local particle   local type = self:GetDTInt(0)  if type == 0 then  for i=1, 12 do  particle = emitter:Add("particles/smokey", pos)  particle:SetDieTime(1.3)  particle:SetColor(c.r, c.g, c.b)  particle:SetStartAlpha(8)  particle:SetEndAlpha(0)  particle:SetStartSize(70)  particle:SetEndSize(0)  particle:SetCollide(true)  particle:SetGravity(Vector(0, 0, 100))  particle:SetVelocity(VectorRand():GetNormal() * 30)  end  for i=0,5 do  particle = emitter:Add("sprites/light_glow02_add", pos)  particle:SetVelocity(VectorRand() * 5)  particle:SetDieTime(0.1)  particle:SetStartAlpha(65)  particle:SetEndAlpha(0)  particle:SetStartSize(math.Rand(137, 139))  particle:SetEndSize(0)  particle:SetRoll(math.Rand(-0.8, 0.8))  particle:SetRollDelta(math.Rand(-3, 3))  particle:SetColor(c.r, c.g, c.b)  end  elseif type == 1 then  for i=0,5 do  particle = emitter:Add("sprites/light_glow02_add", pos)  particle:SetVelocity(VectorRand() * 5)  particle:SetDieTime(0.3)  particle:SetStartAlpha(255)  particle:SetEndAlpha(0)  particle:SetStartSize(math.Rand(67, 69))  particle:SetEndSize(0)  particle:SetRoll(math.Rand(-0.8, 0.8))  particle:SetRollDelta(math.Rand(-3, 3))  particle:SetColor(190, 60, 175)  end  elseif type == 2 then  for i=0,5 do  particle = emitter:Add("sprites/light_glow02_add", pos)  particle:SetVelocity(VectorRand() * 5)  particle:SetDieTime(0.3)  particle:SetStartAlpha(255)  particle:SetEndAlpha(0)  particle:SetStartSize(math.Rand(67, 69))  particle:SetEndSize(0)  particle:SetRoll(math.Rand(-0.8, 0.8))  particle:SetRollDelta(math.Rand(-3, 3))  particle:SetColor(150, 170, 185)  end  end  emitter:Finish() emitter = nil collectgarbage("step", 64)   self.AmbientSound:Stop() end  function ENT:Initialize()  self:SetModelScale(0.75, 0)   self.AmbientSound = CreateSound(self, "ambient/gas/steam2.wav")  self.Created = CurTime() end  function ENT:Think()  self.AmbientSound:PlayEx(0.75, 230 - math.min(2, CurTime() - self.Created) * 20)   self:NextThink(CurTime())  return true end 