AddCSLuaFile()  SWEP.Base = "weapon_zs_basemelee" local BaseClass = baseclass.Get("weapon_zs_basemelee")  SWEP.ZombieOnly = true  SWEP.MeleeDamage = 73 SWEP.Primary.Delay = 1 SWEP.SwingTime = 0.4 SWEP.MeleeRange = 98 SWEP.MeleeSize = 12 SWEP.NoWind = true SWEP.AnimTime = 1.2  SWEP.ChargeDamage = 42 SWEP.ChargeDamageVsPlayerMul = 0.55 SWEP.ChargeReach = 55 SWEP.ChargeSize = 16 SWEP.ChargeStartDelay = 0.65 SWEP.ChargeDelay = 2 SWEP.ChargeRecovery = 0.75 SWEP.ChargeTime = 4 SWEP.ChargeAccel = 0.5 SWEP.ChargeKnockdown = 3  SWEP.StaminaUsage = 0  SWEP.ShowWorldModel = false  SWEP.Secondary.Automatic = false  SWEP.GreatEvil = true  SWEP.NextAllowCharge = 0  SWEP.FakeAttackMulti = 1.1 SWEP.TryAlt = true  if CLIENT then     CreateMaterial( "sigil_blue", "VertexLitGeneric",     {         ["$basetexture"] = "Concrete/concretewall064b",         ["$model"] = 1,         ["$color"] = "[ 0.23 0.64 1 ]",         ["$color2"] = "[ 0.23 0.64 1 ]",         ["$selfillum"] = 1,         ["$selfillummask"] = "Concrete/concretewall064b",         ["$selfillumtint"] = "[2.35 6.4 10]"     } ) end  SWEP.WElements = {  ["glow+++++"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "Antlion_Guard.claw3_L", rel = "leg_front_left++", pos = Vector(-4.249, -4.378, -16.483), size = { x = 45.309, y = 45.309 }, color = Color(60, 164, 255, 201), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["glow++"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "ValveBiped.Bip01_R_Hand", rel = "body++++++", pos = Vector(0, -8.299, 0), size = { x = 103.158, y = 103.158 }, color = Color(60, 164, 255, 55), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_back_right"] = { type = "Model", model = "models/props_wasteland/rockcliff01k.mdl", bone = "Antlion_Guard.leg2_R", rel = "", pos = Vector(32.983, 2.017, -1.88), angle = Angle(98.516, -175.258, -0.746), size = Vector(0.23, 0.224, 0.462), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_left++++++"] = { type = "Model", model = "models/props_wasteland/rockgranite02c.mdl", bone = "Antlion_Guard.claw3_L", rel = "", pos = Vector(44.696, -0.635, 10.531), angle = Angle(-73.842, 105.575, 48.919), size = Vector(0.119, 0.119, 0.119), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["body+"] = { type = "Model", model = "models/props_wasteland/rockgranite01b.mdl", bone = "Antlion_Guard.spine2", rel = "", pos = Vector(0, 1.567, 0), angle = Angle(6.367, -1.048, 57.755), size = Vector(0.209, 0.209, 0.209), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow+++++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(12.265, -17.521, 12.503), size = { x = 15.472, y = 15.472 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["lil_glow++++++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(-19.17, 2.436, 24.622), size = { x = 4.174, y = 4.174 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_front_left+"] = { type = "Model", model = "models/props_wasteland/rockgranite02b.mdl", bone = "Antlion_Guard.claw3_L", rel = "", pos = Vector(4.8, 0.15, 5.434), angle = Angle(76.779, 3.171, 0), size = Vector(0.193, 0.193, 0.193), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_left+++++"] = { type = "Model", model = "models/props_wasteland/rockgranite02a.mdl", bone = "Antlion_Guard.claw1_L", rel = "", pos = Vector(0.342, -0.815, 1.789), angle = Angle(-29.22, -180, -43.708), size = Vector(0.166, 0.166, 0.166), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_left+++"] = { type = "Model", model = "models/props_wasteland/rockgranite03c.mdl", bone = "Antlion_Guard.claw2_L", rel = "", pos = Vector(16.784, 0.81, 1.789), angle = Angle(176.007, -6.716, -0.741), size = Vector(0.497, 0.282, 0.504), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["glow"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "ValveBiped.Bip01_R_Hand", rel = "body", pos = Vector(0, -7.994, 0), size = { x = 148.279, y = 148.279 }, color = Color(60, 164, 255, 107), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_front_right+"] = { type = "Model", model = "models/props_wasteland/rockcliff01f.mdl", bone = "Antlion_Guard.claw2_R", rel = "", pos = Vector(14.619, 0.586, -3.957), angle = Angle(-88.442, 14.005, 1.695), size = Vector(0.105, 0.136, 0.172), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["body++++++"] = { type = "Model", model = "models/props_wasteland/rockcliff01k.mdl", bone = "Antlion_Guard.head", rel = "", pos = Vector(16.437, 0.326, -0.787), angle = Angle(75.789, 150.554, 42.298), size = Vector(0.282, 0.282, 0.282), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_back_right+"] = { type = "Model", model = "models/props_wasteland/rockgranite02c.mdl", bone = "Antlion_Guard.leg1_R", rel = "", pos = Vector(14.581, 2.196, -1.88), angle = Angle(98.516, 99.182, -0.746), size = Vector(0.263, 0.337, 0.312), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow+++++++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body", pos = Vector(-0.848, 17.382, -4.562), size = { x = 9.99, y = 9.99 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_front_right"] = { type = "Model", model = "models/props_wasteland/rockcliff01c.mdl", bone = "Antlion_Guard.claw3_R", rel = "", pos = Vector(37.536, -0.982, -1.961), angle = Angle(-88.442, 14.005, 1.695), size = Vector(0.165, 0.167, 0.238), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_back_left+"] = { type = "Model", model = "models/props_wasteland/rockcliff01f.mdl", bone = "Antlion_Guard.leg2_L", rel = "", pos = Vector(9.314, 7.181, 2.081), angle = Angle(81.844, -26.383, -9.134), size = Vector(0.071, 0.079, 0.104), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_right++++"] = { type = "Model", model = "models/props_wasteland/rockgranite03a.mdl", bone = "Antlion_Guard.claw2_R", rel = "", pos = Vector(50.276, -2.962, 1.94), angle = Angle(-180, -150.991, 1.695), size = Vector(0.136, 0.136, 0.136), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_left"] = { type = "Model", model = "models/props_wasteland/rockgranite02c.mdl", bone = "Antlion_Guard.claw3_L", rel = "", pos = Vector(15.217, -0.741, 0), angle = Angle(-26.982, -89.357, 0), size = Vector(0.141, 0.141, 0.141), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["body+++++"] = { type = "Model", model = "models/props_wasteland/rockgranite02c.mdl", bone = "Antlion_Guard.spine3", rel = "", pos = Vector(21.694, 13.029, 4.282), angle = Angle(-180, -54.909, 32.227), size = Vector(0.27, 0.27, 0.27), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["body++"] = { type = "Model", model = "models/props_wasteland/rockgranite01b.mdl", bone = "Antlion_Guard.spine2", rel = "", pos = Vector(-27.111, 0.689, -12.971), angle = Angle(6.367, -81.572, 57.755), size = Vector(0.098, 0.098, 0.098), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_back_left"] = { type = "Model", model = "models/props_wasteland/rockcliff01g.mdl", bone = "Antlion_Guard.leg2_L", rel = "", pos = Vector(37.534, 3.983, -1.553), angle = Angle(94.536, 8.109, -9.134), size = Vector(0.204, 0.192, 0.171), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_right+++++"] = { type = "Model", model = "models/props_wasteland/rockgranite03a.mdl", bone = "Antlion_Guard.claw2_R", rel = "", pos = Vector(40.944, -12.549, -10.384), angle = Angle(-180, -64.184, 1.695), size = Vector(0.252, 0.252, 0.146), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_right+++"] = { type = "Model", model = "models/props_wasteland/rockcliff01f.mdl", bone = "Antlion_Guard.claw1_R", rel = "", pos = Vector(12.161, 0.361, -4.84), angle = Angle(-88.442, -2.422, 1.695), size = Vector(0.067, 0.104, 0.186), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow+"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body", pos = Vector(25.923, 2.404, -24.675), size = { x = 41.804, y = 41.804 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_back_left+++"] = { type = "Model", model = "models/props_wasteland/rockgranite02a.mdl", bone = "Antlion_Guard.leg1_L", rel = "", pos = Vector(23.978, 7.828, 2.081), angle = Angle(180, -98.067, -9.134), size = Vector(0.143, 0.3, 0.159), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["glow++++++"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "Antlion_Guard.claw2_R", rel = "leg_front_right+++++", pos = Vector(-4.256, 1.003, -3.023), size = { x = 74.89, y = 74.89 }, color = Color(60, 164, 255, 69), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["lil_glow"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body", pos = Vector(9.534, 15.321, -18.748), size = { x = 27.845, y = 27.845 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_front_left++"] = { type = "Model", model = "models/props_wasteland/rockcliff01k.mdl", bone = "Antlion_Guard.claw3_L", rel = "", pos = Vector(28.254, -1.665, 5.434), angle = Angle(97.831, 180, 0), size = Vector(0.167, 0.167, 0.224), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow+++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(-3.116, 13.47, 14.772), size = { x = 10.636, y = 10.636 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["body"] = { type = "Model", model = "models/props_wasteland/rockgranite02b.mdl", bone = "Antlion_Guard.body", rel = "", pos = Vector(15.845, -2.919, -0.339), angle = Angle(71.179, -54.908, 57.755), size = Vector(0.435, 0.435, 0.435), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow++++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(5.547, 8.977, 9.708), size = { x = 6.1, y = 6.1 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_front_left++++"] = { type = "Model", model = "models/props_wasteland/rockgranite03a.mdl", bone = "Antlion_Guard.claw1_L", rel = "", pos = Vector(19.906, 0.81, 1.789), angle = Angle(-71.206, -33.035, -43.708), size = Vector(0.398, 0.4, 0.547), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow++++++++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+++++", pos = Vector(26.763, 12.77, 26.319), size = { x = 13.252, y = 13.252 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["leg_back_left++"] = { type = "Model", model = "models/props_wasteland/rockgranite02a.mdl", bone = "Antlion_Guard.leg1_L", rel = "", pos = Vector(15.47, -4.166, 2.081), angle = Angle(62.285, -98.067, -9.134), size = Vector(0.167, 0.167, 0.167), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["body+++"] = { type = "Model", model = "models/props_wasteland/rockgranite01a.mdl", bone = "Antlion_Guard.spine2", rel = "", pos = Vector(-20.671, 2.206, 8.803), angle = Angle(-40.302, -89.102, 32.227), size = Vector(0.059, 0.059, 0.059), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["glow+"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "ValveBiped.Bip01_R_Hand", rel = "body+++", pos = Vector(-2.253, -43.197, -31.939), size = { x = 137.121, y = 137.121 }, color = Color(60, 164, 255, 75), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["body+++++++"] = { type = "Model", model = "models/props_wasteland/rockgranite01a.mdl", bone = "Antlion_Guard.head", rel = "", pos = Vector(-5.29, -8.624, -4.821), angle = Angle(-148.92, 70.363, 42.298), size = Vector(0.064, 0.064, 0.064), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(-3.116, -9.221, 14.772), size = { x = 20.093, y = 20.093 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["glow++++"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "Antlion_Guard.leg1_R", rel = "leg_back_right+", pos = Vector(6.879, -11.035, -1.956), size = { x = 76.402, y = 76.402 }, color = Color(60, 164, 255, 92), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["glow+++"] = { type = "Sprite", sprite = "effects/yellowflare", bone = "Antlion_Guard.leg2_L", rel = "leg_back_left++", pos = Vector(-0.571, -12.9, 0), size = { x = 116.737, y = 116.737 }, color = Color(60, 164, 255, 144), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["body++++"] = { type = "Model", model = "models/props_wasteland/rockgranite03a.mdl", bone = "Antlion_Guard.spine3", rel = "", pos = Vector(10.967, 0.187, -4.387), angle = Angle(-133.65, 21.833, 32.227), size = Vector(0.764, 0.764, 0.537), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["lil_glow++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body", pos = Vector(9.472, 8.47, -24.675), size = { x = 12.548, y = 12.548 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["lil_glow+++++"] = { type = "Sprite", sprite = "effects/blueflare1", bone = "ValveBiped.Bip01_R_Hand", rel = "body+", pos = Vector(-13.723, 17.294, 4.308), size = { x = 4.572, y = 4.572 }, color = Color(39, 208, 255, 255), nocull = true, additive = true, vertexalpha = true, vertexcolor = true, ignorez = false},  ["body++++++++"] = { type = "Model", model = "models/props_wasteland/rockgranite02b.mdl", bone = "Antlion_Guard.body", rel = "", pos = Vector(18.575, 1.029, 9.201), angle = Angle(32.133, -134.823, 62.987), size = Vector(0.395, 0.395, 0.18), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} },  ["leg_front_right++"] = { type = "Model", model = "models/props_wasteland/rockgranite03a.mdl", bone = "Antlion_Guard.claw2_R", rel = "", pos = Vector(34.877, -0.091, -5.492), angle = Angle(-88.442, -131.09, 1.695), size = Vector(0.284, 0.284, 0.284), color = Color(255, 255, 255, 255), surpresslightning = false, material = "!sigil_blue", skin = 0, bodygroup = {} } }  function SWEP:OnMeleeHit(hitent, hitflesh, tr)  if hitent:IsValidPlayer() then  local vel = hitent:GetPos() - self:GetOwner():GetPos()  vel.z = 0  vel:Normalize()  vel = vel * 400  vel.z = 200   if CurTime() >= (hitent.NextKnockdown or 0) then  hitent:KnockDown()  hitent.NextKnockdown = CurTime() + 4  end  hitent:SetGroundEntity(NULL)  hitent:SetVelocity(vel)  end   local owner = self:GetOwner()  local forward = owner:GetForward()   local hit_props = {  [hitent] = true  }  local count = 1.5  for i = 2, 8 do  local incu = -5 + i  local damage = 85   local ang = forward:Angle()  ang:RotateAroundAxis(owner:GetUp(), incu * 12 + math.random(1, -1))  ang:RotateAroundAxis(owner:GetRight(), math.random(5, -5))  local dir = ang:Forward()   local shift = math.random(45, 90)   local tr = owner:CompensatedMeleeTrace(121, 25, owner:WorldSpaceCenter() - dir * shift, dir)  local e = tr.Entity   if SERVER and IsValid(e) and not e:IsPlayer() and not hit_props[e] then  e:TakeSpecialDamage(damage/count, DMG_SLASH, owner, self, tr.HitPos)   hit_props[e] = true  count = count + 0.1  end  end end  function SWEP:CanPrimaryAttack()  return self:GetNextPrimaryFire() <= CurTime() and not self:IsSwinging() and not self:IsWinding() end  function SWEP:PrimaryAttack()  if not self:CanPrimaryAttack() then return end   self:SetNextAttack()   if self.SwingTime == 0 then  self:MeleeSwing()  else  self:StartWinding()  end end  function SWEP:Think()  local curtime = CurTime()  local owner = self:GetOwner()   if self.NextAllowJump and self.NextAllowJump <= curtime then  self.NextAllowJump = nil   owner:ResetJumpPower()  end   if self.IdleAnimation and self.IdleAnimation <= CurTime() then  self.IdleAnimation = nil  self:SendWeaponAnim(ACT_VM_IDLE)  end   local holdingleft = owner:KeyDown(IN_ATTACK)  local swinging = self:IsSwinging()  local winding = self:IsWinding()   local windend = CurTime() - self:GetWindStart() > self.Primary.Delay * 0.5  if winding and (not holdingleft or windend or self.Primary.Delay < 0.55 or self.NoWind) then  self:SetHeavy(CurTime() - self:GetWindStart() > self.Primary.Delay * 0.4)  self:StopWind()  self:StartSwinging()  self:SetNextAttack()  end   if swinging and self:GetSwingEnd() <= CurTime() then  self:StopSwinging()  self:MeleeSwing()  self:SetHeavy(false)  end   if self:IsCharging() then  if owner:WaterLevel() >= 2 or CurTime() > self:GetChargeStart() + self.ChargeTime  then  self:StopCharge()  elseif IsFirstTimePredicted() then  local dir = owner:GetVelocity()  dir:Normalize()   local chargemul = math.min(self:GetCharge(), owner:GetVelocity():LengthSqr() / 193600)  local traces = owner:CompensatedZombieMeleeTrace(self.ChargeReach, self.ChargeSize, owner:WorldSpaceCenter(), dir)  local damage = 78   local hit = false  for _, trace in ipairs(traces) do  if not trace.Hit then continue end   if trace.HitWorld then  if trace.HitNormal.z < 0.8 then  hit = true  end  else  local ent = trace.Entity  if ent and ent:IsValid() and not ent:IsProjectile() and (not ent.NextKnockdown or CurTime() >= (ent.NextKnockdown or 0)) then  self:ApplyMeleeDamage(ent, trace, damage * (ent:IsPlayer() and self.ChargeDamageVsPlayerMul or ent.PounceWeakness or 1))  if ent:IsPlayer() then  ent:ThrowFromPositionSetZ(trace.StartPos, 320 * chargemul + owner:GetVelocity():Length() * 0.5)  if CurTime() >= (ent.NextKnockdown or 0) then  ent:GiveStatus("debuff_knockdown", self.ChargeKnockdown * chargemul, owner)  ent.NextKnockdown = CurTime() + 1 * chargemul  end  end  end  end  end   if hit then  self:PlayChargeHitSound()  self:StopCharge()  end  end  elseif self:GetChargeStart() > 0 and CurTime() > self:GetChargeStart() then  self:StartCharge()  elseif self.m_ViewAngles then  self.m_ViewAngles = nil  end   BaseClass.Think(self) end  function SWEP:ApplyMeleeDamage(hitent, tr, damage)  if not IsFirstTimePredicted() then return end   local owner = self:GetOwner()   local dmginfo = DamageInfo()  dmginfo:SetDamagePosition(tr.HitPos)  dmginfo:SetAttacker(owner)  dmginfo:SetInflictor(self)  dmginfo:SetDamageType(DMG_CRUSH)  dmginfo:SetDamage(damage)  dmginfo:SetDamageForce(math.min(damage, 50) * 50 * owner:GetAimVector())   local vel  if hitent:IsPlayer() then  if SERVER then  hitent:SetLastHitGroup(tr.HitGroup)  if tr.HitGroup == HITGROUP_HEAD then  hitent:SetWasHitInHead()  end   if hitent:WouldDieFrom(damage, tr.HitPos) then  dmginfo:SetDamageForce(math.min(damage, 50) * 400 * owner:GetAimVector())  end  end   vel = hitent:GetVelocity()  end   hitent:DispatchTraceAttack(dmginfo, tr, owner:GetAimVector())      if vel then  hitent:SetLocalVelocity(vel)  end end  function SWEP:SecondaryAttack()  if self:IsCharging() or self:GetChargeStart() > 0 then return end   if self:GetOwner():IsOnGround() then  if CurTime() < self:GetNextPrimaryFire() or CurTime() < self:GetNextSecondaryFire() or CurTime() < self.NextAllowCharge then return end   self:SetNextPrimaryFire(math.huge)  self:SetChargeStart(CurTime() + self.ChargeStartDelay)   self:GetOwner():ResetJumpPower()  if IsFirstTimePredicted() then  self:PlayChargeStartSound()  end  end end  function SWEP:PlayChargeHitSound()  self:EmitSound("npc/antlion_guard/shove1.wav", 85, math.random(50,56), nil, CHAN_AUTO) end  function SWEP:PlayChargeStartSound()  self:EmitSound("npc/ichthyosaur/attack_growl1.wav", 85, math.random(50,56), nil, CHAN_AUTO)  self:EmitSound("npc/combine_gunship/see_enemy.wav", 85, math.random(90, 100), 0.7, CHAN_WEAPON + 20) end  function SWEP:StartSwinging()  local owner = self:GetOwner()   if self.StartSwingAnimation then  self:SendWeaponAnim(self.StartSwingAnimation)  self.IdleAnimation = CurTime() + self:SequenceDuration()  end  self:PlayStartSwingSound()   local armdelay = owner:GetMeleeSpeedMul()  self:SetSwingEnd(CurTime() + self.SwingTime * (owner.MeleeSwingDelayMul or 1) * armdelay)  self:SetAnimEnd(CurTime() + self.AnimTime * (owner.MeleeSwingDelayMul or 1) * armdelay)   owner.SanityTime = (owner.SanityTime or 0) + 1  if SERVER and owner.SanityTime >= 10 then  timer.Simple(1.25, function()  if not (owner:IsValidLivingZombie() and self:IsValid()) then return end   local spawn = table.Random(team.GetValidSpawnPoint(TEAM_UNDEAD))   if CurTime() >= (owner.NextSigilTeleportationEffect or 0) then  owner.NextSigilTeleportationEffect = CurTime() + 0.25   local effect = "sigil_teleport"   owner:EmitSound("ambient/machines/teleport1.wav", 85, 110)   local effectdata = EffectData()  effectdata:SetOrigin(owner:WorldSpaceCenter())  effectdata:SetEntity(owner)  util.Effect(effect, effectdata, true, true)  util.Effect("explosion_wispball", effectdata, true, true)  effectdata:SetOrigin(spawn:WorldSpaceCenter())  util.Effect(effect, effectdata, true, true)  end   local movepos = spawn:GetPos() % 2   for i=1, 5 do  owner:SetPos(movepos)  owner:SetLocalPos(movepos)  end  hook.Add("Move", owner, function(_, p, mv)  if p == owner then  hook.Remove("Move", p)  mv:SetOrigin(movepos)  end  end)   owner.SanityTime = 0  end)  end end  function SWEP:Move(mv)  local charge = self:GetCharge()   if self:GetChargeStart() > 0 and charge <= 0 then  mv:SetMaxSpeed(0)  mv:SetMaxClientSpeed(0)  elseif charge > 0 then  mv:SetForwardSpeed(10000)  mv:SetSideSpeed(mv:GetSideSpeed() * 0.1)   local mul = 1 + charge * 0.8  mv:SetMaxSpeed(mv:GetMaxSpeed() * mul)  mv:SetMaxClientSpeed(mv:GetMaxClientSpeed() * mul)  end end  function SWEP:SetChargeStart(time)  self:SetDTFloat(1, time) end  function SWEP:GetChargeStart()  return self:GetDTFloat(1) end  function SWEP:GetCharge()  if self:GetChargeStart() == 0 then return 0 end   return math.Clamp((CurTime() - self:GetChargeStart()) / self.ChargeAccel, 0, 1) end  function SWEP:SetCharging(charging)  self:SetDTBool(2, charging) end  function SWEP:GetCharging()  return self:GetDTBool(2) end SWEP.IsCharging = SWEP.GetCharging  function SWEP:PostOnMeleeHit(hitent, hitflesh, tr) end  function SWEP:StartCharge()  if self:IsCharging() then return end   local owner = self:GetOwner()  if owner:IsOnGround() then  self:SetCharging(true)  self.m_ViewAngles = owner:EyeAngles()  owner:SetAnimation(PLAYER_JUMP)  else  self:SetNextSecondaryFire(CurTime())  self.m_ViewAngles = nil  self.NextAllowJump = CurTime()  self.NextAllowCharge = CurTime() + self.ChargeDelay  self:SetNextPrimaryFire(CurTime() + self.ChargeRecovery)  self:GetOwner():ResetJumpPower()  end end  function SWEP:StopCharge()  if not self:IsCharging() then return end   self:SetChargeStart(0)  self:SetCharging(false)  self:SetNextSecondaryFire(CurTime())  self.m_ViewAngles = nil  self.NextAllowJump = CurTime() + 0.25  self.NextAllowCharge = CurTime() + self.ChargeDelay  self:SetNextPrimaryFire(CurTime() + self.ChargeRecovery)  self:GetOwner():ResetJumpPower()  self.CriticalCharge = nil end  function SWEP:SetNextAttack()  local owner = self:GetOwner()  local armdelay = owner:GetMeleeSpeedMul()  self:SetNextPrimaryFire(CurTime() + self.Primary.Delay * armdelay)  owner:EmitSound("npc/combine_gunship/ping_patrol.wav", 85, math.random(160, 170))  owner:EmitSound("npc/combine_gunship/see_enemy.wav", 85, math.random(90, 100), 0.7, CHAN_WEAPON + 20)  owner:AddLegDamage(16) end  function SWEP:PlaySwingSound()  self:EmitSound("weapons/iceaxe/iceaxe_swing1.wav", 75, math.random(30, 40)) end  function SWEP:PlayHitSound()  self:EmitSound("npc/antlion_guard/shove1.wav", 72, math.Rand(85, 105)) end  function SWEP:PlayHitFleshSound()  self:EmitSound("physics/flesh/flesh_squishy_impact_hard"..math.random(4)..".wav")  self:EmitSound("physics/body/body_medium_break"..math.random(2, 4)..".wav") end  function SWEP:SetAnimEnd(aend)  self:SetDTFloat(10, aend) end  function SWEP:GetAnimEnd()  return self:GetDTFloat(10) end 