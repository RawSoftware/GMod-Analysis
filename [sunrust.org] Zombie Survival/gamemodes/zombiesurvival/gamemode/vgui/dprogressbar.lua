local PANEL = {}  local width = 320  function PANEL:Init()     local screenscale = BetterScreenScale()   self:RefreshSize()  self:SetPos(ScrW() * 0.5 - screenscale * width * 0.5, 0) end  function PANEL:RefreshSize()     local screenscale = BetterScreenScale()   self:SetSize(screenscale * width, screenscale * 200) end  function PANEL:Think()     if MySelf.Team and MySelf:Team() == TEAM_HUMAN and GAMEMODE.BountyProgress == 0 or         (not GAMEMODE.DemibarAlways and GAMEMODE.DemiProgress < GAMEMODE.DemibossProgressRequired and MySelf.KeyDown and not MySelf:KeyDown(GAMEMODE.MenuKey)) then          self:SetVisible(false)     end end  local flavour_demiboss = 1 local flavour_bounty = 2 local function GetProgressFlavour()     local pl_team = MySelf:Team()     if pl_team == TEAM_ZOMBIE then         return flavour_demiboss     elseif pl_team == TEAM_HUMAN and GAMEMODE.BountyProgress > 0 then         return flavour_bounty     end end  local matGlow = Material("sprites/glow04_noz") local texDownEdge = surface.GetTextureID("gui/gradient_down") local bar_color = Color(230, 170, 60) function PANEL:Paint()     if not MySelf or not MySelf.Team then return end     local flavour = GetProgressFlavour()     if not flavour then return end      local screenscale = BetterScreenScale()     local bar_width = width * screenscale     local percent =         flavour == flavour_demiboss and math.min(1, GAMEMODE.DemiProgress / GAMEMODE.DemibossProgressRequired) or         flavour == flavour_bounty   and math.Clamp(GAMEMODE.BountyProgress / GAMEMODE.BountyProgressRequired, 0, 1)     local hei = 18 * screenscale     local x, y = 0, hei * 2     local subwidth = percent * bar_width      if percent == 1 then         local pulse = math.sin(CurTime() * 4) * 60         local flavour_col_r =   flavour == flavour_demiboss and 200 or                                 flavour == flavour_bounty   and 100         local flavour_col_g =   flavour == flavour_demiboss and 140 or                                 flavour == flavour_bounty   and 30         local flavour_col_b =   flavour == flavour_demiboss and 30 or                                 flavour == flavour_bounty   and 140          bar_color.r = flavour_col_r + pulse         bar_color.g = flavour_col_g + pulse         bar_color.b = flavour_col_b + pulse     else         local flavour_col_r =   flavour == flavour_demiboss and 230 or                                 flavour == flavour_bounty   and 140         local flavour_col_g =   flavour == flavour_demiboss and 170 or                                 flavour == flavour_bounty   and 60         local flavour_col_b =   flavour == flavour_demiboss and 60 or                                 flavour == flavour_bounty   and 170          bar_color.r = flavour_col_r         bar_color.g = flavour_col_g * (percent * 0.6 + 0.4)         bar_color.b = flavour_col_b * (percent * 0.6 + 0.4)     end      surface.SetDrawColor(0, 0, 0, 230)     surface.DrawRect(x, y, bar_width, hei)      surface.SetDrawColor(bar_color.r, bar_color.g, bar_color.b, 160)     surface.SetTexture(texDownEdge)     surface.DrawTexturedRect(x + 2, y + 1, subwidth - 4, hei - 2)     surface.SetDrawColor(bar_color.r, bar_color.g, bar_color.b, 30)     surface.DrawRect(x + 2, y + 1, subwidth - 4, hei - 2)      surface.SetMaterial(matGlow)     surface.SetDrawColor(255, 255, 255, 255)     surface.DrawTexturedRect(x + 2 + subwidth - 6, y + 1 - hei/2, 4, hei * 2)      local progress_text =         flavour == flavour_bounty   and "Bounty Progress" or         flavour == flavour_demiboss and "Demiboss Progress"     draw.SimpleText(progress_text, "ZSHUDFontSmall", x + bar_width/2, y - hei * 1, bar_color, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)      if flavour == flavour_demiboss and percent == 1 then         local demi_name = GAMEMODE.SelectedDemiClass         local spawn_text = GAMEMODE.DemiClaimed and (             demi_name and "Spawning as a " .. demi_name or             "Press to F3 to select demiboss"         ) or (             GAMEMODE:GetWave() > 1 and "Press F2 to become a demiboss" or             "Demibosses unlock on Wave 2"         )          draw.SimpleText(spawn_text, "ZSHUDFontSmallest", x + bar_width/2, y + hei * 0.5, bar_color, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)     end end  vgui.Register("DProgressBar", PANEL, "DPanel") 