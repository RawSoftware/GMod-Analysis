CLASS.Base = "wraith"  CLASS.Name = "Spectre" CLASS.TranslationName = "class_spectre" CLASS.Description = "description_spectre" CLASS.Help = "controls_spectre"  CLASS.Health = 240 CLASS.Points = (CLASS.Health/GM.NoHeadboxZombiePointRatio) * 1.5 CLASS.Speed = 185  CLASS.Wave = 5 / 6  CLASS.SWEP = "weapon_zs_spectre" CLASS.Cat = ZCLASSCAT_ASSAULT  function CLASS:Move(pl, move)  local wep = pl:GetActiveWeapon()  if not wep.GetTormented then return end   if CurTime() < wep:GetTormented() + 2 then  move:SetMaxSpeed(255)  move:SetMaxClientSpeed(255)  end   if pl:KeyDown(IN_SPEED) then  move:SetMaxSpeed(40)  move:SetMaxClientSpeed(40)  end end  function CLASS:PlayDeathSound(pl)  for i=1, 4 do  pl:EmitSound("zombiesurvival/wraithdeath4.ogg", 75, math.random(80, 140), 0.6, CHAN_AUTO + i)  end   return true end  function CLASS:DoAnimationEvent(pl, event, data)  if event == PLAYERANIMEVENT_ATTACK_PRIMARY then  pl:DoZombieAttackAnim(data)  return ACT_INVALID  elseif event == PLAYERANIMEVENT_RELOAD then  pl:AnimRestartGesture(GESTURE_SLOT_ATTACK_AND_RELOAD, ACT_GMOD_GESTURE_TAUNT_ZOMBIE, true)  return ACT_INVALID  end end  if SERVER then  function CLASS:ProcessDamage(pl, dmginfo)  local activ = pl:GetActiveWeapon()  if not activ.GetTormented then return end   local attacker, dmg = dmginfo:GetAttacker(), dmginfo:GetDamage()  if not attacker:IsValidLivingHuman() or CurTime() < activ:GetTormented() + 8 then return end   if pl:Health() - dmg < 150 then  for i = 0, 3 do  timer.Simple(0.04 * i,  function() if pl:IsValidLivingZombie() then pl:EmitSound("npc/stalker/go_alert2a.wav", 75, 120 + i*12, 0.4, CHAN_WEAPON + i) end  end)  end   activ:SetTormented(CurTime())  end  end end  function CLASS:GetAlpha(pl)  local wep = pl:GetActiveWeapon()  if not wep.IsAttacking then wep = NULL end   if wep:IsValid() and wep:IsAttacking() then  return 0.7  end   local eyepos = EyePos()  local nearest = pl:WorldSpaceCenter()  local norm = nearest - eyepos  norm:Normalize()  local dot = EyeVector():Dot(norm)   local vis = (dot * 0.3 + pl:GetVelocity():Length() / self.Speed / 3 - eyepos:Distance(nearest) / 500) * dot   return math.Clamp(vis, MySelf:IsValid() and MySelf:Team() == TEAM_UNDEAD and 0.137 or 0, 0.7) end  if not CLIENT then return end  CLASS.Icon = "zombiesurvival/killicons/wraithv2" CLASS.IconColor = Color(255, 150, 255)  function CLASS:PrePlayerDraw(pl)  local alpha = self:GetAlpha(pl)  if alpha == 0 then return true end   render.SetBlend(alpha)  render.SetColorModulation(0.2, 0.025, 0.25)  render.SuppressEngineLighting(true) end 